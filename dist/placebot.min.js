!function(){"use strict";var t,e=r.place;r.placeModule("",function(e){t=e("api")});var i=function(){this.toPlace=[],this.tileSelector=i.selector.TopDown,this.drawTimer=void 0,this.minTimer=100,this.lastDrawTime=0,console.log(["------------",,"PlaceBot "+i.version,"------------"].join("\n")),this.load(),this._setTimer()};Object.defineProperties(i.prototype,{cooldownRemaining:{get:function(){return this.nextDrawTime-Date.now()}},nextDrawTime:{get:function(){return r.place.cooldownEndTime}},canDraw:{get:function(){return this.cooldownRemaining<0&&this.lastDrawTime!==this.nextDrawTime}}}),i.prototype._importObject=function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return{success:!1,error:t.message}}return{success:!0,data:t}},i.prototype._settingsObject=function(){return{tileSelector:this.tileSelector.name,minTimer:this.minTimer}},i.prototype.exportTiles=function(){return JSON.stringify(this.toPlace)},i.prototype.importTiles=function(t){var e=this._importObject(t);if(!e.success)return console.log("Failed to import tiles: %s",e.error),!1;this.toPlace=e.data},i.prototype.exportSettings=function(){return JSON.stringify(this._settingsObject())},i.prototype.importSettings=function(t){var e=this._importObject(t);if(!e.success)return console.log("Failed to import settings: %s",e.error),!1;var o=Object.assign(this._settingsObject(),o);this.tileSelector=i.selector[o.tileSelector]||i.selector.TopDown,this.minTimer=o.minTimer},i.prototype.exportBot=function(){return JSON.stringify({settings:this._settingsObject(),tiles:this.toPlace})},i.prototype.importBot=function(t){var e=this._importObject(t);if(!e.success)return console.log("Failed to import bot: %s",e.error),!1;this.importSettings(e.data.settings),this.importTiles(e.data.tiles)},i.prototype.save=function(){localStorage.setItem("placebot_settings",this.exportSettings()),localStorage.setItem("placebot_tiles",this.exportTiles())},i.prototype.load=function(){this.importSettings(localStorage.getItem("placebot_settings")),this.importTiles(localStorage.getItem("placebot_tiles"))},i.prototype._setTimer=function(){clearTimeout(this.drawTimer);var t=Math.max(this.minTimer,this.cooldownRemaining);this.drawTimer=setTimeout(this.drawNext.bind(this),t),console.log("Scheduled draw in %sms",t)},i.prototype.drawNext=function(){if(this.canDraw&&this.toPlace.length){var e=this.tileSelector(this.toPlace),i=this.toPlace.splice(e,1)[0],o=this;t.getPixelInfo(i[0],i[1]).then(function(t){t.color!==i[2]&&o.drawTile.apply(o,i),o._setTimer()})}o._setTimer()},i.prototype.drawTile=function(t,i,o){this.canDraw&&(this.lastDrawTime=this.nextDrawTime,e.colorIndex=o,e.drawTile(t,i),console.log("Drawing %s at (%s, %s)",e.palette[o],t,i))},i.version="0.0.4",i.selector={TopDown:function(t){var e=-1,i=1/0,o=1/0;return t.forEach(function(t,r){(t[1]<o||t[1]===o&&t[0]<i)&&(e=r,i=t[0],o=t[1])}),e},BottomUp:function(t){var e=-1,i=-1,o=-1;return t.forEach(function(t,r){(t[1]>o||t[1]===o&&t[0]>i)&&(e=r,i=t[0],o=t[1])}),e},Random:function(t){return Math.floor(Math.random()*t.length)},DrawOrder:function(t){return 0}},window.placeBot=new i}();