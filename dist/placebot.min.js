!function(){"use strict";var t=r.place,e=function(){this.toPlace=[],this.tileSelector=e.selector.TopDown,this.drawTimer=void 0,this.minTimer=100,this.lastDrawTime=0,this.drawNext(),console.log(["------------",,"PlaceBot "+e.version,"------------"].join("\n"))};Object.defineProperties(e.prototype,{cooldownRemaining:{get:function(){return this.nextDrawTime-Date.now()}},nextDrawTime:{get:function(){return r.place.cooldownEndTime}},canDraw:{get:function(){return this.cooldownRemaining<0&&this.lastDrawTime!==this.nextDrawTime}}}),e.prototype._importObject=function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){return{success:!1,error:t.message}}return{success:!0,data:t}},e.prototype._settingsObject=function(){return{tileSelector:this.tileSelector.name,minTimer:this.minTimer}},e.prototype.exportTiles=function(){return JSON.stringify(this.toPlace)},e.prototype.importTiles=function(t){var e=this._importObject(t);if(!e.success)return console.log("Failed to import tiles: %s",e.error),!1;this.toPlace=e.data},e.prototype.exportSettings=function(){return JSON.stringify(this._settingsObject())},e.prototype.importSettings=function(t){var i=this._importObject(t);if(!i.success)return console.log("Failed to import settings: %s",i.error),!1;var o=i.data;Object.assign(this._settingsObject(),o),this.tileSelector=e.selector[o.tileSelector]||e.selector.TopDown,this.minTimer=o.minTimer},e.prototype.exportBot=function(){return JSON.stringify({settings:this._settingsObject(),tiles:this.toPlace})},e.prototype.importBot=function(t){var e=this._importObject(t);if(!e.success)return console.log("Failed to import bot: %s",e.error),!1;this.importSettings(e.data.settings),this.importTiles(e.data.tiles)},e.prototype.save=function(){localStorage.setItem("placebot_settings",this.exportSettings()),localStorage.setItem("placebot_tiles",this.exportTiles())},e.prototype.load=function(){this.importSettings(localStorage.getItem("placebot_settings")),this.importTiles(localStorage.getItem("placebot_tiles"))},e.prototype.drawNext=function(){if(this.canDraw&&this.toPlace.length){var t=this.tileSelector(this.toPlace);this.drawTile.apply(this,this.toPlace[t]),this.toPlace.splice(t,1)}clearTimeout(this.drawTimer);var e=Math.max(this.minTimer,this.cooldownRemaining);setTimeout(this.drawNext.bind(this),e),console.log("Scheduled draw in %sms",e)},e.prototype.drawTile=function(e,i,o){this.canDraw&&(this.lastDrawTime=this.nextDrawTime,t.colorIndex=o,t.drawTile(e,i),console.log("Drawing %s at (%s, %s)",t.palette[o],e,i))},e.version="0.0.2",e.selector={TopDown:function(t){var e=-1,i=1/0,o=1/0;return t.forEach(function(t,r){(t[1]<o||t[1]===o&&t[0]<i)&&(e=r,i=t[0],o=t[1])}),e},Random:function(t){return Math.floor(Math.random()*t.length)},DrawOrder:function(t){return 0}},new e}();